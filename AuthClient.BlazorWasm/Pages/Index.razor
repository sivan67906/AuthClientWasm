@page "/"
@using Microsoft.AspNetCore.Components.Authorization
@inject AuthenticationStateProvider AuthStateProvider

<PageTitle>Home</PageTitle>

<div class="container mt-5">
    <h1>Welcome to Auth Microservice</h1>
    
    <AuthorizeView>
        <Authorized>
            <div class="alert alert-success mt-4">
                <h4>You are logged in!</h4>
                <p>Email: @context.User.Identity?.Name</p>
                <p>Roles: @string.Join(", ", context.User.Claims.Where(c => c.Type == "http://schemas.microsoft.com/ws/2008/06/identity/claims/role").Select(c => c.Value))</p>
            </div>
            <div class="mt-3">
                <a href="/profile" class="btn btn-primary">View Profile</a>
                <button class="btn btn-secondary" @onclick="Logout">Logout</button>
            </div>
        </Authorized>
        <NotAuthorized>
            <div class="alert alert-info mt-4">
                <h4>You are not logged in</h4>
                <p>Please login or register to access the application.</p>
            </div>
            <div class="mt-3">
                <a href="/login" class="btn btn-primary">Login</a>
                <a href="/register" class="btn btn-secondary">Register</a>
            </div>
        </NotAuthorized>
    </AuthorizeView>

    <div class="mt-5">
        <h3>Features</h3>
        <ul class="list-group">
            <li class="list-group-item">✓ JWT Authentication with Refresh Tokens</li>
            <li class="list-group-item">✓ Role-Based Authorization</li>
            <li class="list-group-item">✓ Claims-Based Authorization</li>
            <li class="list-group-item">✓ Policy-Based Authorization</li>
            <li class="list-group-item">✓ Multi-Client Support (Web/Android/iOS)</li>
            <li class="list-group-item">✓ CQRS with Dual Database (SQL Server + PostgreSQL)</li>
            <li class="list-group-item">✓ Vertical Slice Architecture</li>
        </ul>
    </div>
</div>

@code {
    [CascadingParameter]
    private Task<AuthenticationState>? AuthenticationStateTask { get; set; }

    private async Task Logout()
    {
        // Implement logout logic
        await Task.CompletedTask;
    }
}
